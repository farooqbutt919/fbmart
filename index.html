<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> Farooqs Mart</title>
    <!-- Add some CSS to change client UI -->
    <style>

    #heading {
        font-size: 36px;
        color: #eb770b;
        margin: 20px 0;
        }
      
    #subheading {
        font-size: 18px;
        margin-bottom: 20px;
        }
    
    body {
        background-color: #090e14;
        }
    label, button {
        color: #FF9900;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 20px;
        margin-left: 40px;
        }
     input {
        color: #232F3E;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 20px;
        margin-left: 20px;
        }
    </style>
    <!-- Add the AWS SDK for JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/aws-sdk/2.1147.0/aws-sdk.min.js"></script>

<!-- Your existing HTML -->

<script>
  var callAPI = (username, password, firstName, lastName) => {
    // AWS Cognito configuration
    AWS.config.region = 'us-east-1'; // e.g., us-east-1

    var authenticationData = {
      Username: username,
      Password: password,
    };

    var authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails(
      authenticationData
    );

    var poolData = {
      UserPoolId: 'yus-east-1_5OjJm8ohZ',
      ClientId: '3lfru8jon7qus53oh99a17kinm',
    };

    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

    var userData = {
      Username: username,
      Pool: userPool,
    };

    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);

    // Authenticate the user
    cognitoUser.authenticateUser(authenticationDetails, {
      onSuccess: function (session) {
        // User authentication successful, call your API
        var requestOptions = {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            Authorization: session.getIdToken().getJwtToken(),
          },
          body: JSON.stringify({
            firstName: firstName,
            lastName: lastName,
          }),
        };

        fetch('https://rgzwtkh1p9.execute-api.us-east-1.amazonaws.com/dev', requestOptions)
          .then((response) => response.text())
          .then((result) => alert(JSON.parse(result).body))
          .catch((error) => console.log('error', error));
      },
      onFailure: function (err) {
        // Handle authentication failure
        console.log('Authentication failed', err);
      },
    });
  };
</script>
</head>
<body>

    <h1 id="heading">FB-Mart</h1>
    <p id="subheading" style="color:#eb770b;">Executive service to address your cravings during office hours</p>
    <form>
        <label>First Name :</label>
        <input type="text" id="fName">
        <label>Last Name :</label>
        <input type="text" id="lName">
        <!-- set button onClick method to call function we defined passing input values as parameters -->
        <button type="button" onclick="callAPI(document.getElementById('fName').value,document.getElementById('lName').value)"> Whats In the Grocery</button>
    </form>
</body>
</html>